CREATE DATABASE PROJECT;
USE PROJECT;

####################### CREATING TEMPORARY USER INSTANCE ###############################################

CREATE TEMPORARY TABLE TEMP_PLAYERS  
SELECT P.USRNM, U.PSWD   
FROM PLAYERS P  
INNER JOIN USERS U ON P.EMAIL = U.EMAIL 
ORDER BY P.USRNM;

######################## CREATING TABLES AND INSERTING VALUES ###########################################

CREATE TABLE CATEGORIES (CID INT NOT NULL, CNAME VARCHAR(15), PRIMARY KEY(CID));

CREATE TABLE QUESTIONS (QID INT NOT NULL, QUESTION VARCHAR (50), OID INT NOT NULL, CID INT,
                        PRIMARY KEY(QID), FOREIGN KEY (CID) REFERENCES CATEGORIES(CID));

INSERT INTO CATEGORIES VALUES (1,'SCIENCE'),(2,'COMPUTER'),(3,'GK'),(4,'VEHICLES'),(5,'NATURE'),(6,'MEDICINES'),(7,'MOBILE'),(8,'PROGRAMMING'),(9,'HARDWARE'),(10,'SOFTWARE'),(11,'CRICKET'),(12,'FOOTBALL'),(13,'NEWS'),(14,'BUSINESS'),(15,'SLOGANS');


INSERT INTO QUESTIONS VALUES (1,"WHO WAS THE ANCIENT GREEK GOD OF THE SUN?",1,3);

CREATE VIEW GK AS
SELECT QUESTION
FROM QUESTIONS
WHERE CID = 3;

CREATE TABLE OPTIONS (OID INT NOT NULL, OPTION1 VARCHAR(25), OPTION2 VARCHAR(25), OPTION3 VARCHAR(25), OPTION4 VARCHAR(25), QID INT,
                      PRIMARY KEY(OID), FOREIGN KEY(QID) REFERENCES QUESTIONS(QID));

ALTER TABLE OPTIONS ADD AID INT

UPDATE OPTIONS SET AID = 3

UPDATE OPTIONS SET AID = 3 WHERE OID = 1

INSERT INTO OPTIONS VALUES (1,"HERMES","POSEIDON","APOLLO","HERCULES",1)

CREATE TABLE ANSWERS (AID INT NOT NULL, ANSWERS VARCHAR(25), QID INT NOT NULL, OID INT NOT NULL, PRIMARY KEY (AID),
                      FOREIGN KEY (QID) REFERENCES QUESTIONS (QID),
                      FOREIGN KEY (OID) REFERENCES OPTIONS (OID));

INSERT INTO ANSWERS VALUES (3,"APOLLO",1,1);

################################## CREATING CUSTOM VIEW OPTIONS ############################################

CREATE VIEW QUESTION_OPTIONS AS 
SELECT Q.QUESTION,O.OPTION1,O.OPTION2,O.OPTION3,O.OPTION4 FROM QUESTIONS Q, OPTIONS O WHERE Q.QID = O.QID

SELECT * FROM QUESTION_OPTIONS;

ALTER TABLE ANSWERS RENAME COLUMN ANSWERS TO ANSWER;

CREATE VIEW QUESTION_ANSWER AS
SELECT Q.QUESTION, A.ANSWER FROM QUESTIONS Q, ANSWERS A WHERE Q.QID = A.QID;

SELECT * FROM QUESTION_ANSWER;

################################### DELETING CATEGORY ########################################################

DELETE C.CNAME, Q.QUESTION, O.OPTION1, O.OPTION2, O.OPTION3, O.OPTION4, A.ANSWER 
FROM CATEGORIES C, QUESTION Q, OPTIONS O, ANSWER A 
WHERE C.CID = Q.CID AND Q.QID = O.QID AND O.OID = A.OID;